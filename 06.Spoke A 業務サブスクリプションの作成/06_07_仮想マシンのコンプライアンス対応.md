# 仮想マシンのコンプライアンス対応

以下の設定で、各コンプライアンススクリプトを実行

```bash
# 対象サブスクリプションの指定
TEMP_TARGET_SUBSCRIPTION_IDS=$SUBSCRIPTION_ID_SPOKE_A
 
# 業務システム A チーム／① 初期構築の作業アカウントに切り替え
if ${FLAG_USE_SOD} ; then az account clear ; az login -u "user_spokea_dev@${PRIMARY_DOMAIN_NAME}" -p "${ADMIN_PASSWORD}" ; fi

```

上記の設定で以下 4 つのスクリプトを実行

- [WindowsOS] ゲストアカウントのリネーム
- [WindowsOS] Windows Defender Exploit Guard 有効化
- [Windows OS] CSB 適用
- [Linux OS] CSB 適用

```bash 
# 業務システム統制チーム／③ 構成変更の作業アカウントに切り替え
if ${FLAG_USE_SOD} ; then az account clear ; az login -u "user_gov_change@${PRIMARY_DOMAIN_NAME}" -p "${ADMIN_PASSWORD}" ; fi
```

上記の設定で以下 4 つのスクリプトを実行

- VM Insights 有効化
- MDfS 有効化
- Update Management 有効化
- プラットフォームメトリックの LAW への出力

```bash 
# 業務システム A チーム／① 初期構築の作業アカウントに切り替え
if ${FLAG_USE_SOD} ; then az account clear ; az login -u "user_spokea_dev@${PRIMARY_DOMAIN_NAME}" -p "${ADMIN_PASSWORD}" ; fi
```

上記の設定で以下のスクリプトを実行

- （参考）GC ルールが外れてしまった場合 (Windows 用)

